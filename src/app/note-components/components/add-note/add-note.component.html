<div class="stretch-slide-in-toleft-hor">
    <form id="form-container" [formGroup]="noteForm">


        <input id="title" type="text" placeholder="Write your title..."  formControlName="title">


        <div id="tags-section" formArrayName="codetags">
            <div *ngIf="tagsEditingMode" id="tags-search">
                <div id="search-bar" class="slide-in-ver">
                    <i class="bx bx-search"></i>
                    <input type="text" placeholder="Search tag..." (input)="onSearchTagTyping($event)">
                    <i class="bx bx-x delete-tag-icon" (click)="disableTagsEditingMode()"></i>
                </div>
                <div class="tags-flex" id="tags-found" *ngIf="areTagsFound">
                    <app-tag [isClickable]="true" [text]="tag" startAnimation="slide-in-ver" *ngFor="let tag of searchedTags" (onClickEvent)="onAddTag(tag)"></app-tag>
                </div>
            </div>
            <div class="tags-flex">
                <app-tag [isClosable]="tagsEditingMode" [text]="tag.name" startAnimation="slide-in-ver" endAnimation="slide-out-totop" *ngFor="let tag of codetags.value; let i = index" (onCloseEvent)="onDeleteTag(i)"></app-tag>
                <i *ngIf="!tagsEditingMode" id="edit-tags-icon" class="bx bxs-pencil" (click)="enableTagsEditingMode()"></i>
            </div>
        </div>


        <div id="description-section">
            <app-autoresizeable-textarea placeholder="Write your description..." formControlName="description"></app-autoresizeable-textarea>
        </div>


        <div id="codes-section" formArrayName="codes">
            <div class="section-title">
                Code snippets
                <i id="add-item-btn" class="bx bx-plus" (click)="onAddCode(0)"></i>
            </div>
            <div class="stretch-slide-in-toleft-hor" *ngFor="let codeCard of codeCards; let i = index">
                <div id="single-code" [formGroup]="codeCard.codeForm">
                    <div id="code-header">
                        <div id="code-header-left-part">
                            <i class="bx bx-code-block"></i>
                            <select id="code-language" formControlName="language" (change)="refreshLanguageHighlight(codeCard)">
                                <option id="language-option" *ngFor="let l of codeLanguages" value="{{l.language}}">{{l.language}}</option>
                            </select>
                        </div>
                        <i id="delete-code-icon" class="bx bx-x" (click)="onDeleteCode(i)"></i>
                    </div>
                    <div id="code-editing-card" *ngIf="codeCard.isEditMode; else codeElseBlock">
                        <app-autoresizeable-textarea id="code-editor" [ngClass]="{'loading-highlight': codeCard.isRefreshingCodeLanguage}" fontColor="white" backgroundColor="rgb(40, 40, 40)" placeholder="Write your code..." formControlName="code">
                        </app-autoresizeable-textarea>
                        <i id="valid-code-icon" class="bx bx-check" *ngIf="codeCard.codeForm.value.code.length > 0 && !codeCard.isRefreshingCodeLanguage" (click)="disableCodeEditingMode(codeCard)"></i>
                        <i *ngIf="codeCard.isRefreshingCodeLanguage" id="spinner" class="bx bx-loader-alt bx-spin"></i>
                    </div>
                    <ng-template #codeElseBlock>
                        <app-code-card (click)="enableCodeEditingMode(codeCard)" [codeSnippet]="codeCard.codeForm.value"></app-code-card>
                    </ng-template>
                    <div id="code-description">
                        <i class="bx bx-comment-detail"></i>
                        <app-autoresizeable-textarea fontColor="lightgrey" placeholder="Write your description..." formControlName="description"></app-autoresizeable-textarea>
                    </div>
                </div>
            </div>
        </div>


        <button id="submit-button" class="nc-simple-button fade-in" type="submit" (click)="onSubmitForm()" [hidden]="noteForm.invalid || !isNoteChanged">SAVE</button>


    </form>
</div>
